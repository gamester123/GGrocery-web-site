This is the final code. 1st update.
